<!DOCTYPE html>
<html lang="es">


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power BI Analytics - AetherCubix</title>
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="styles/admin.css">
    <link rel="stylesheet" href="styles/admin-guard.css">
    <link rel="stylesheet" href="styles/insights.css">
    <link rel="stylesheet" href="styles/powerbi.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- Botón hamburguesa para menú lateral -->
    <button class="menu-toggle" id="menuToggle" aria-label="Abrir menú">
        <i class="fas fa-bars"></i>
    </button>
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    <div class="admin-layout">
        <!-- Sidebar -->
        <nav class="admin-sidebar" id="adminSidebar">
            <div class="sidebar-header">
                <i class="fas fa-cube"></i>
                <span>AetherCubix Admin</span>
            </div>
            <ul class="sidebar-menu">
                <li><a href="index.html" class="active" onclick="mostrarSeccion('dashboard')"><i
                            class="fas fa-chart-bar"></i> Dashboard</a></li>
                <li><a href="#pedidos" onclick="mostrarSeccion('pedidos')"><i class="fas fa-shopping-cart"></i> Gestión
                        de Pedidos</a></li>
                <li><a href="gestion-productos.html"><i class="fas fa-box"></i> Gestión de Productos</a></li>
                <li><a href="power-bi.html"><i class="fas fa-chart-pie"></i> Power BI Analytics</a></li>
                <li><a href="ai-assistant.html"><i class="fas fa-robot"></i> Asistente IA</a></li>
                <li><a href="../index.html"><i class="fas fa-arrow-left"></i> Volver al sitio</a></li>
            </ul>
        </nav>

        <!-- Main content -->
        <main class="admin-main">
            <header class="admin-header">
                <h1 id="page-title">Power BI Analytics</h1>
                <div class="admin-user">
                    <i class="fas fa-user-circle"></i>
                    <span>Administrador</span>
                    <button class="btn-notification" id="notifications-btn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-count" id="notification-count">0</span>
                    </button>
                </div>
            </header>

            <div class="admin-content">
                <div class="section-header">
                    <h2><i class="fas fa-chart-pie"></i> Power BI Analytics</h2>
                    <div class="section-actions">
                        <button class="btn btn-primary" onclick="exportToExcel()">
                            <i class="fas fa-file-excel"></i> Exportar Excel
                        </button>
                        <button class="btn btn-outline" onclick="exportToCSV()">
                            <i class="fas fa-file-csv"></i> Exportar CSV
                        </button>
                    </div>
                </div>

                <div class="info-box">
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <p><strong>Importante:</strong> Para ver los informes completos, necesitas acceder a Power BI
                            Service o instalar la aplicación de Power BI Desktop.</p>
                        <p>Puedes <a href="https://app.powerbi.com/" onclick="exportToPowerBI()">exportar los datos</a>
                            para importarlos en tu
                            instancia de Power BI.</p>
                    </div>
                </div>

                <div class="powerbi-options">
                    <h3>Visualización En Power BI</h3>
                    <!-- IFRAME INTEGRADO AL PRINCIPIO -->
                    <div style="display:flex;justify-content:center;margin:30px 0;">
                        <iframe title="Cubix" width="800" height="500"
                            src="https://app.powerbi.com/view?r=eyJrIjoiYTg5OTZkNDEtNWE4NC00M2FiLWJiODUtZDllMWVhNmU1NmQxIiwidCI6IjVmNTNiNGNlLTYzZDQtNGVlOC04OGQyLTIyZjBiMmQ0YjI3YSIsImMiOjR9"
                            frameborder="0" allowFullScreen="true"></iframe>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Script para Power BI Embedded -->
    <script type="module" src="scripts/admin-guard.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/powerbi-client/dist/powerbi.min.js"></script>
    <script type="module" src="scripts/powerbi.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <script type="module" src="scripts/powerbi-real.js"></script>

    <script>
        function showExportSection() {
            document.querySelectorAll('.powerbi-option').forEach(opt => opt.classList.remove('active'));
            document.querySelector('.powerbi-option:nth-child(1)').classList.add('active');
            document.getElementById('powerbi-export-section').style.display = 'block';
            document.getElementById('powerbi-embedded-reports').style.display = 'none';
        }

        function showEmbeddedReports() {
            document.querySelectorAll('.powerbi-option').forEach(opt => opt.classList.remove('active'));
            document.querySelector('.powerbi-option:nth-child(2)').classList.add('active');
            document.getElementById('powerbi-export-section').style.display = 'none';
            document.getElementById('powerbi-embedded-reports').style.display = 'block';

            // Cargar informe embebido (después de publicar en Power BI)
            const iframe = document.getElementById('powerbi-iframe');
            // Reemplazar con tu URL de informe publicado
            iframe.src = "https://app.powerbi.com/view?r=CODIGO_DE_TU_INFORME";
        }
    </script>
    <script>
        const menuToggle = document.getElementById('menuToggle');
        const adminSidebar = document.getElementById('adminSidebar');
        const sidebarOverlay = document.getElementById('sidebarOverlay');
        const adminHeader = document.querySelector('.admin-header');

        function openSidebar() {
            adminSidebar.classList.add('open');
            sidebarOverlay.classList.add('active');
            if (window.innerWidth < 900 && adminHeader) {
                adminHeader.classList.add('hide-on-menu');
            }
        }
        function closeSidebar() {
            adminSidebar.classList.remove('open');
            sidebarOverlay.classList.remove('active');
            if (adminHeader) {
                adminHeader.classList.remove('hide-on-menu');
            }
        }
        menuToggle.addEventListener('click', function () {
            if (adminSidebar.classList.contains('open')) {
                closeSidebar();
            } else {
                openSidebar();
            }
        });
        sidebarOverlay.addEventListener('click', closeSidebar);

        document.querySelectorAll('.admin-sidebar a').forEach(link => {
            link.addEventListener('click', () => {
                if (window.innerWidth < 900) closeSidebar();
            });
        });
    </script>
</body>

</html>